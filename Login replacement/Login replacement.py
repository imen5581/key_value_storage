import requests
import xlrd


class BearerAuth(requests.auth.AuthBase):
    def __init__(self, token):
        self.token = token

    def __call__(self, r):
        r.headers["authorization"] = "Bearer " + self.token
        return r


class Datalogin():
    def __init__(self, value_1, value_2):
        self.value_1 = value_1
        self.value_2 = value_2

    def create_dictionary(self) -> {}:
        list_1 = self.value_1
        list_2 = self.value_2
        data = dict(zip(list_1, list_2))
        return data


list1 = [2653096, 2652951, 2652924, 2653090, 2653037, 2653111, 2653100, 2653128, 2652971, 2653121, 2653139, 114142, 2652935, 2722824, 2652963, 2653092, 2652974, 2653053, 2653079, 303324, 2652968, 2653028, 2652936, 2652957, 2652933, 2722849, 2653072, 2653068, 2653099, 2653087, 2652970, 2653129, 2653088, 2652953, 2653105, 2653054, 2652921, 2653132, 2652954, 2652942, 2653052, 2653098, 2653021, 652894, 2653046, 2652975, 2653082, 2653055, 2653123, 357596, 2653042, 2653071, 2653115, 2652994, 2652956, 2653140, 238414, 2653107, 2653081, 2653060, 2652987, 2653089, 146662, 2653118, 2653119, 2653026, 2653000, 2653001, 200663, 2652943, 2652941, 2653095, 2652977, 2722850, 2653062, 2653008, 2653103, 2653027, 2653097, 2652996, 2653141, 2653047, 2653004, 2653038, 2653018, 2652979, 2653083, 2653014, 2653076, 3055193, 2652978, 2653122, 2653017, 2653020, 2653051, 2653085, 131169, 190858, 2652980, 101657, 2653146, 2653031, 2653134, 2652991, 74215, 2652981, 2653030, 2653130, 2653093, 2653002, 2722835, 2653074, 2653106, 2653048, 2653044, 2653003, 2653041, 2653131, 2653005, 2653077, 2652967, 2653011, 2653039, 2652985, 2652982, 2652997, 75037, 112744, 124750, 194466, 203174, 226124, 357595, 2652972, 114139, 368984, 375019, 151615, 2647529, 335528, 2652988, 2880733, 2757385, 2653110, 240486, 2653113, 2652995, 2652923, 2653040, 2653025, 2652925, 2653050, 2653033, 2652966, 2652937, 2652938, 2653120, 2653078, 2757141, 2652946, 2653075, 2652949, 2652973, 2653135, 2653104, 2722923, 2653112, 2652962, 2653086, 2652998, 2757264, 2653136, 2653049, 2653144, 2653102, 2652990, 2653056, 2653101, 2653009, 2652959, 2653145, 304157, 2652928, 2652958, 2653012, 2653006, 2652931, 2652986, 2652940, 2653137, 2653024, 2653073, 2653043, 151619, 2757394, 2881251, 3055200, 2872758, 2722924, 114577, 365209]
list2 = ["mdarenskaya@groupe-atlantic.com", "ksmeyanova@groupe-atlantic.com", "nsafronova@groupe-atlantic.com", "ivasina@groupe-atlantic.com", "ssenyushkina@groupe-atlantic.com", "smalygin@groupe-atlantic.com", "ozimina@groupe-atlantic.com", "atuymakaeva@groupe-atlantic.com", "tvolkova@groupe-atlantic.com", "arazuvaev@groupe-atlantic.com", "ayaroshev@groupe-atlantic.com", "vtulyakov@groupe-atlantic.com", "isokolova@groupe-atlantic.com", "nmesheryakova@groupe-atlantic.com", "mbondarenko@groupe-atlantic.com", "goncharova@groupe-atlantic.com", "tgalkina@groupe-atlantic.com", "yzagrafova@groupe-atlantic.com", "ekalenik@groupe-atlantic.com", "sshustov@groupe-atlantic.com", "evalchenko@groupe-atlantic.com", "arezvova@groupe-atlantic.com", "mtishkova@groupe-atlantic.com", "marlashina@groupe-atlantic.com", "ekavashkina@groupe-atlantic.com", "dyacenko@groupe-atlantic.com", "spunenko@groupe-atlantic.com", "ekarpova@groupe-atlantic.com", "izhukova@groupe-atlantic.com", "nbondareva@groupe-atlantic.com", "zvoznesenskaya@groupe-atlantic.com", "afedorova@groupe-atlantic.com", "aborisov@groupe-atlantic.com", "asharova@groupe-atlantic.com", "okuznetsova@groupe-atlantic.com", "mkorovin@groupe-atlantic.com", "sakimova@groupe-atlantic.com", "mchitaishvili@groupe-atlantic.com", "abaturin@groupe-atlantic.com", "askrebtsov@groupe-atlantic.com", "icheusova@groupe-atlantic.com", "dermolina@groupe-atlantic.com", "vpichikin@groupe-atlantic.com", "aovchinnikova@groupe-atlantic.com", "achumak@groupe-atlantic.com", "sganelin@groupe-atlantic.com", "elallahverdiev@groupe-atlantic.com", "mkozyrev@groupe-atlantic.com", "zsavina@groupe-atlantic.com", "rusupov@groupe-atlantic.com", "gturshina@groupe-atlantic.com", "ialekseev@groupe-atlantic.com", "noficerova@groupe-atlantic.com", "mkarapetyan@groupe-atlantic.com", "kaleksandrova@groupe-atlantic.com", "yluchkina@groupe-atlantic.com", "ssvetlov@groupe-atlantic.com", "jkurova@groupe-atlantic.com", "uaydarova@groupe-atlantic.com", "jprotakovskaya@groupe-atlantic.com", "ozabalueva@groupe-atlantic.com", "mborisova@groupe-atlantic.com", "tpiryazeva@groupe-atlantic.com", "oplatonova@groupe-atlantic.com", "dprokopenko@groupe-atlantic.com", "apchelkina@groupe-atlantic.com", "ekosyachkova@groupe-atlantic.com", "vkudinkina@groupe-atlantic.com", "vsorokina@groupe-atlantic.com", "iserebryakov@groupe-atlantic.com", "lEpifanova@groupe-atlantic.com", "kgusarov@groupe-atlantic.com", "egritskova@groupe-atlantic.com", "vyakimova@groupe-atlantic.com", "dsadrieva@groupe-atlantic.com", "ilukina@groupe-atlantic.com", "tkizesova@groupe-atlantic.com", "dradetskaya@groupe-atlantic.com", "edomrina@groupe-atlantic.com", "iklykova@groupe-atlantic.com", "apavlinskiy@groupe-atlantic.com", "ikornesku@groupe-atlantic.com", "нет (Работает в настоящее время, без компьютера)", "vserova@groupe-atlantic.com", "mmorozova@groupe-atlantic.com", "mguk@groupe-atlantic.com", "aandruk@groupe-atlantic.com", "amenkova@groupe-atlantic.com", "ekrivoruchenko@groupe-atlantic.com", "nkiryan@groupe-atlantic.com", "aguzhov@groupe-atlantic.com", "orudaya@groupe-atlantic.com", "afilippova@groupe-atlantic.com", "aPegov@groupe-atlantic.com", "ayasnovskiy@groupe-atlantic.com", "aafanasiev@groupe-atlantic.com", "yaltuhova@groupe-atlantic.com", "nhamidulina@groupe-atlantic.com", "egustilin@groupe-atlantic.com", "lsidorenko@groupe-atlantic.com", "nerastova@groupe-atlantic.com", "esazonova@groupe-atlantic.com", "oshpilevskaya@groupe-atlantic.com", "akablov@groupe-atlantic.com", "vtelegina@groupe-atlantic.com", "idaragan@groupe-atlantic.com", "vsazonova@groupe-atlantic.com", "vhesin@groupe-atlantic.com", "agorshynov@groupe-atlantic.com", "lkulikova@groupe-atlantic.com", "kzaharov@groupe-atlantic.com", "tbarmina@groupe-atlantic.com", "vkuzmin@groupe-atlantic.com", "mshtraukhman@groupe-atlantic.com", "afilippov@groupe-atlantic.com", "slavrushin@groupe-atlantic.com", "sstepanova@groupe-atlantic.com", "gchepurdeeva@groupe-atlantic.com", "jleonova@groupe-atlantic.com", "dnasadova@groupe-atlantic.com", "sbychkova@groupe-atlantic.com", "amateruhin@groupe-atlantic.com", "tsmirnova@groupe-atlantic.com", "edulnev@groupe-atlantic.com", "ddzhulanov@groupe-atlantic.com", "kklyev@groupe-atlantic.com", "mgolovanova@groupe-atlantic.com", "kdubov@groupe-atlantic.com", "aepanchintseva@groupe-atlantic.com", "ekurasova@groupe-atlantic.com", "нет  (В декрете, работает с компьютером)", "ybykova@groupe-atlantic.com", "epashentseva@groupe-atlantic.com", "agalkin@groupe-atlantic.com", "vlizel@groupe-atlantic.com", "tstroikina@groupe-atlantic.com", "rkozlov@groupe-atlantic.com", "oakimenkova@groupe-atlantic.com", "sabrosimova@groupe-atlantic.com", "nbaranova@groupe-atlantic.com", "gzarochintseva@groupe-atlantic.com", "aonishchenko@groupe-atlantic.com", "kanisimov@groupe-atlantic.com", "dmadin@groupe-atlantic.com", "amiroshkina@groupe-atlantic.com", "amitroshkin@groupe-atlantic.com", "lkartashova@groupe-atlantic.com", "aafanasyev@groupe-atlantic.com", "vstepanenko@groupe-atlantic.com", "npozdnyakov@groupe-atlantic.com", "tchereshnuk@groupe-atlantic.com", "nyarkova@groupe-atlantic.com", "echistakova@groupe-atlantic.com", "gBystrov@groupe-atlantic.com", "eveselova@groupe-atlantic.com", "akucher@groupe-atlantic.com", "bpurtov@groupe-atlantic.com", "oshulakov@groupe-atlantic.com", "kbelozerova@groupe-atlantic.com", "sfrantseva@groupe-atlantic.com", "aponosov@groupe-atlantic.com", "emorozova@groupe-atlantic.com", "egalkina@groupe-atlantic.com", "ashurikova@groupe-atlantic.com", "dkuzakov@groupe-atlantic.com", "avalidjanova@groupe-atlantic.com", "omalisheva@groupe-atlantic.com", "vbelyaev@groupe-atlantic.com", "mbelyaeva@groupe-atlantic.com", "ekomissarova@groupe-atlantic.com", "epogrebnyak@groupe-atlantic.com", "ascherbatyh@groupe-atlantic.com", "escherbitsky@groupe-atlantic.com", "ahudyakova@groupe-atlantic.com", "kivanova@groupe-atlantic.com", "yzubareva@groupe-atlantic.com", "myurovskaya@groupe-atlantic.com", "eivanov@groupe-atlantic.com", "elyabina@groupe-atlantic.com", "abalandin@groupe-atlantic.com", "npanova@groupe-atlantic.com", "mkondratyk@groupe-atlantic.com", "tgorinchoy@groupe-atlantic.com", "oartemov@groupe-atlantic.com", "ematukhina@groupe-atlantic.com", "vligay@groupe-atlantic.com", "tzhukova@groupe-atlantic.com", "jefimova@groupe-atlantic.com", "ivornikov@groupe-atlantic.com", "eyamaletdinova@groupe-atlantic.com", "oplotnikov@groupe-atlantic.com", "tsheller@groupe-atlantic.com", "sfilatov@groupe-atlantic.com", "nkhoroshkina@groupe-atlantic.com", "ihohlov@groupe-atlantic.com", "sbarichko@groupe-atlantic.com", "vkrasichenok@groupe-atlantic.com", "nkashin@groupe-atlantic.com", "rtsarkov@groupe-atlantic.com", "tfilatova@groupe-atlantic.com", "defimov@groupe-atlantic.com"]

data_login = Datalogin(list1, list2).create_dictionary()

for id in data_login.keys():
    response = requests.post(f'https://go.teachbase.ru/endpoint/v1/users/{id}/login?email={data_login[id]}',
                             auth=BearerAuth('Br7IlhgkhW4vmJlUU901JXQ6f6KLmqQVWuLQPUTLDU8'), timeout = 2)


